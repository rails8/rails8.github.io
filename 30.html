---
layout: day
title: Stub API requests in tests
number: "30"
prev_page: /29-fetch-estimate-from-openai
permalink: /30-stub-api-requests-in-tests
asciinema: KZbFNn9HupBqEyyr
---

<p>We do not want tests to hit OpenAI API and charge us for each request.</p>

<ol style="padding-left: 0; list-style-position: inside">
  <li style="margin-top: 0.75rem"><a href="#"><span class="badge rounded-pill bg-primary">▶︎</span></a> Add the webmock gem to stub HTTP requests.</li>
  <li style="margin-top: 0.75rem"><a href="#"><span class="badge rounded-pill bg-secondary-subtle">▶︎</span></a> Set up webmock to work with Playwright.</li>
  <li style="margin-top: 0.75rem"><a href="#"><span class="badge rounded-pill bg-secondary-subtle">▶︎</span></a> Write mocks to emulate Twilio and OpenAI responses.</li>
  <li style="margin-top: 0.75rem"><a href="#"><span class="badge rounded-pill bg-secondary-subtle">▶︎</span></a> Include the mocked estimate in the tests.</li>
</ol>
